{extend name='public/base' /}
{block name='content'}

<section class="content" xmlns="http://www.w3.org/1999/html">

    <div class="container-fluid">


        <!-- form content -->
        <div class="card">
            <div class="card-body">

                <form id="dataForm" class="form-horizontal dataForm" action="" method="post"
                      enctype="multipart/form-data">
                    <!-- Columns start at 50% wide on mobile and bump up to 33.3% wide on desktop -->

                    <div class="form-group row">
                        <div class="col-lg-10">
                            <a class="btn flat btn-sm btn-default BackButton" href="index.html">
                                <i class="fa fa-arrow-left"></i>
                                Back
                            </a>
                        </div>

                        <div class="col-lg-2">
                            <button type="submit" class=" far fa-file-alt  btn flat btn-info  dataFormSubmit  btn-sm  ">
                                Save
                            </button>

                            <button type="submit" class="fa fa-trash  btn flat btn-danger  dataFormSubmit btn-sm">
                                Delete
                            </button>
                        </div>
                    </div>

                    <div class="row pt-2">
                        <div class="col-xs-12 col-md-4">

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="quotation_no">Quotation No</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="quotation_no" name="quotation_no"
                                           value="{$data.quotation_no|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="created_at"> Create Date</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="created_at" name="created_at"
                                           value="{$data.created_at|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="payment_term">Payment Terms</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="payment_term" name="payment_term"
                                           value="{$data.payment_term|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="approval_status">Approval Status</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="approval_status" name="approval_status"
                                           value="{$data.approval_status|default=''}"
                                           >
                                </div>
                            </div>


                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="account_id">Billing Account</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="account_id" name="account_id"
                                           value="{$data.account_id|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="billing_phone">Billing Phone</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="billing_phone" name="billing_phone"
                                           value="{$data.billing_phone|default=''}"
                                           >
                                </div>
                            </div>


                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="from_user">Sales Rep</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="from_user" name="from_user"
                                           value="{$data.from_user|default=''}"
                                           >
                                </div>
                            </div>


                        </div>


                        <div class="col-xs-12 col-md-4">
                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="revision_no">Revision</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="revision_no" name="revision_no"
                                           value="{$data.revision_no|default=''}"
                                           >
                                </div>
                            </div>


                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="expiry_date">Expiry Date</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="expiry_date" name="expiry_date"
                                           value="{$data.expiry_date|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="default_currency">Currency</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="default_currency"
                                           name="default_currency"
                                           value="{$data.default_currency|default=''}"
                                           >
                                </div>
                            </div>


                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="contact_id">Contact</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="contact_id"
                                           name="contact_id"
                                           value="{$data.contact_id|default=''}"
                                           >
                                </div>
                            </div>


                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="billing_fax"> Billing Fax</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="billing_fax" name="billing_fax"
                                           value="{$data.billing_fax|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="from_phone">Direct Line</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="from_phone" name="from_phone"
                                           value="{$data.from_phone|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="from_mobile">Mobile</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="from_mobile" name="from_mobile"
                                           value="{$data.from_mobile|default=''}"
                                           >
                                </div>
                            </div>

                        </div>


                        <div class="col-xs-12 col-md-4">
                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="quo_type">Quotations type</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="quo_type" name="quo_type"
                                           value="{$data.quo_type|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="reference_po">Your Ref.</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="reference_po" name="reference_po"
                                           value="{$data.reference_po|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="cc">C.C.to</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="cc" name="cc"
                                           value="{$data.cc|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="billing_address"> Billing Address</label>
                                <div class="col-md-7">
                            <textarea class="form-control" id="billing_address" name="billing_address" size="1"
                                      value="{$data.billing_address|default=''}"
                                      ></textarea>
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="from_email">E-mail</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="email" id="from_email" name="from_email"
                                           value="{$data.from_email|default=''}"
                                           >
                                </div>
                            </div>

                            <div class="form-group row">
                                <label class="col-md-3 control-label" for="from_fax">Fax</label>
                                <div class="col-md-7">
                                    <input class="form-control" type="text" id="from_fax" name="from_fax"
                                           value="{$data.from_fax|default=''}"
                                           >
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="table-responsive g-mb-40 ">
                        <table class="table u-table--v3--bordered g-color-black">
                            <thead >
                            <tr >
                                <th class="text-center">Item</th>
                                <th class="text-center">Description</th>
                                <th class="text-center">Amount(HKD)</th>
                                <th>
                                    <a class="js-edit u-link-v5 g-color-gray-light-v6 g-color-secondary--hover"
                                       href="#">
                                        <i class="fa fa-plus" id="add-line"></i>
                                    </a>
                                </th>
                            </tr>
                            </thead>

                            <tbody id="tbody">
                            {empty name="quo_items"}
                            <tr>
                                <input type="hidden" name="item[0][id]">
                                <td><input class="form-control" type="text" name="item[0][name]"></td>
                                <td><input class="form-control" type="text" name="item[0][description]"></td>
                                <td><input class="form-control amount" type="text" name="item[0][amount]"></td>
                                <td>
                                    <a class="u-link-v5 g-color-gray-light-v6 g-color-secondary--hover g-text-underline--none--hover"
                                       href="#">
                                        <i class="fa fa-minus"></i>
                                    </a>
                                </td>
                            </tr>
                            {else/}
                            {foreach name="quo_items" id="items" key="key"}
                            <tr>
                                <input type="hidden" name="item[{$key}][id]" value="{$items.id}">
                                <td><input class="form-control" type="text" name="item[{$key}][name]"
                                           value="{$items.name}"></td>
                                <td><input class="form-control" type="text" name="item[{$key}][description]"
                                           value="{$items.description}"></td>
                                <td><input class="form-control amount" type="text" name="item[{$key}][amount]"
                                           value="{$items.amount}"></td>
                                <td>
                                    <a class="u-link-v5 g-color-gray-light-v6 g-color-secondary--hover g-text-underline--none--hover"
                                       href="#">
                                        <i class="fa fa-minus"></i>
                                    </a>
                                </td>
                            </tr>
                            {/foreach}
                            {/empty}
                            </tbody>
                        </table>
                    </div>


                    <div class="card-body">
                        <form class="form-horizontal" action="lyear_forms_elements.html" method="post"
                              onsubmit="return false;">

                            <!-- Columns start at 50% wide on mobile and bump up to 33.3% wide on desktop -->
                            <div class="row p-t-15">
                                <div class="col-xs-12 col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-3 control-label" for="total">Total:</label>
                                        <div class="col-md-7">
                                            <input class="form-control" type="text" id="total" name="total"
                                                   value="{$data.total|default=''}"
                                                   placeholder="0.0">
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-md-3 control-label" for="total_discount">Special Discount
                                            (%):</label>
                                        <div class="col-md-7">
                                            <input class="form-control" type="text" id="total_discount"
                                                   name="total_discount"
                                                   value="{$data.total_discount|default=''}"
                                                   placeholder="0.0">
                                        </div>
                                    </div>

                                    <div class="form-group row">
                                        <label class="col-md-3 control-label" for="deduction">Special Discount
                                            Amt:</label>
                                        <div class="col-md-7">
                                            <input class="form-control" type="text" id="deduction" name="deduction"
                                                   value="{$data.deduction|default=''}"
                                                   placeholder="0.0">
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group row">
                                        <label class="col-md-3 control-label" for="tax_rate">Tax rate (%):</label>
                                        <div class="col-md-7">
                                            <input class="form-control" type="text" id="tax_rate" name="tax_rate"
                                                   value="{$data.tax_rate|default=''}"
                                                   placeholder="0.0">
                                        </div>
                                    </div>

                                    <div class="form-group row">
                                        <label class="col-md-3 control-label" for="final_total">Net Amount:</label>
                                        <div class="col-md-7">
                                            <input class="form-control" type="text" id="final_total" name="final_total"
                                                   value="{$data.final_total|default=''}"
                                                   placeholder="0.0">
                                        </div>
                                    </div>

                                </div>


                                <div class="col-xs-12 col-md-6">
                                    <div class="form-group row">
                                        <label class="col-md-3 control-label" for="terms_conditions">Terms and
                                            Conditions</label>
                                        <div class="col-md-7">
                            <textarea class="form-control" id="terms_conditions" name="terms_conditions" size="1"
                                      value="{$data.terms_conditions|default=''}"
                                      ></textarea>
                                        </div>
                                    </div>


                                    <div class="form-group row">
                                        <label class="col-md-3 control-label" for="terms">Add standard terms</label>
                                        <div class="col-md-7">
                                            <input class="form-control" type="text" id="terms" name="terms"
                                                   value="{$data.terms|default=''}"
                                                   >
                                        </div>
                                    </div>

                                    <div class="form-group row">
                                        <label class="col-md-3 control-label" for="remark">Remark</label>
                                        <div class="col-md-7">
                            <textarea class="form-control" id="remark" name="remark" size="1"
                                      value="{$data.remark|default=''}"
                                      placeholder="Price valid for 30 days since the issue of this agreement,subject to change without further notice."></textarea>
                                        </div>
                                    </div>

                                </div>
                            </div>


                            <div class="form-group row">
                                <label class="col-md-1 control-label" for="owner_user_id">Security Owner</label>
                                <div class="col-md-2">
                                    <select class="form-control" id="owner_user_id" name="owner_user_id" size="1">
                                        <option value="0">ken kuo</option>
                                        <option value="1">Admin Adaptive</option>
                                        <option value="2">Leo Wong</option>
                                        <option value="3">Luke Tam</option>
                                        <option value="4">Ron Kaluta</option>
                                        <option value="5">Rooky lu</option>
                                        <option value="6">Sandy Ng</option>
                                        <option value="7">Syatem User</option>
                                        <option value="8">Tiffany Cheng</option>
                                    </select>
                                </div>

                                <label class="col-md-1 control-label" for="assigned_user_id">Assign to user</label>
                                <div class="col-md-2">
                                    <select class="form-control" id="assigned_user_id" name="assigned_user_id" size="1">
                                        <option value="0">Ken Kuo</option>
                                        <option value="1">Admin Adaptive</option>
                                        <option value="2">Ken Kuo</option>
                                        <option value="3">Leo wong</option>
                                        <option value="4">Luke Tam</option>
                                        <option value="5">Ron Kaluta</option>
                                        <option value="6">Rooky lu</option>
                                        <option value="7">Sandy Ng</option>
                                        <option value="8">System User</option>
                                        <option value="9">Tiffany Cheng</option>
                                    </select>
                                </div>

                                <label class="col-md-1 control-label" for="visible_for">Visible for</label>
                                <div class="col-md-2">
                                    <select class="form-control" id="visible_for" name="visible_for" size="1">
                                        <option value="0">Authorised Team</option>
                                        <option value="1">All</option>
                                        <option value="2">My Team</option>
                                        <option value="3">Myself</option>
                                    </select>
                                </div>

                                <label class="col-md-1 control-label" for="team_id">Assign to team</label>
                                <div class="col-md-2">
                                    <select class="form-control" id="team_id" name="team_id" size="1">
                                        <option value="0">Administrator</option>
                                        <option value="1">Marketing</option>
                                        <option value="2">memberson</option>
                                        <option value="3">Sales</option>
                                        <option value="4">Training</option>
                                        <option value="5">Trial</option>
                                        <option value="6">Zhuhai</option>

                                    </select>
                                </div>
                            </div>

                        </form>
                    </div>
                </form>
            </div>
            <!--sub page--->
        </div>
    </div><!--/. container-fluid -->
</section>
{/block}
{block name="js"}

<script type="text/javascript">

    $('.fa-plus').click(function () {
        let node = '';
        let index = $('.table').children('tbody').children('tr').length;
        node += '<tr><input type="hidden" name="item[' + index + '][id]"><td><input class="form-control" type="text" name="item[' + index + '][name]"></td><td><input class="form-control" type="text" name="item[' + index + '][description]"></td><td><input class="form-control amount" type="text" name="item[' + index + '][amount]"></td><td><a class="u-link-v5 g-color-gray-light-v6 g-color-secondary--hover g-text-underline--none--hover" href="#"><i class="fa fa-minus"></i></a></td></tr>';
        $('.table').children('tbody').append(node);
    })

    $(document).on("click", '.fa-minus', function () {
        let len = 0;
        len = $('.table').children('tbody').children('tr').length;
        if (len > 1) {
            $(this).parents('tr').remove();
            total();
        }
    })




    $(document).on("change", ".amount", function () {
        total();
    })

    function total() {
        let total = 0.00;

        $(".amount").each(function () {
            total += parseFloat($(this).val());

            $("#total").val(total.toFixed(2));
        });

        amount();
    }

     $(document).on("change",".amount",function () {
         total_discount();
     })

     function total_discount(){
        let total_discount= total;
        
        $(".amount").each(function () {

        })
     }

    

    $(document).on("change", "#deduction", function () {
        amount();
    })

    function amount() {
        let total = parseFloat($("#total").val());
        let deduction = $("#deduction").val();

        if (deduction == '') {
            deduction = 0
        }

        let final_total = total - parseFloat(deduction);
        $("#final_total").val(final_total.toFixed(2));
    }









</script>
{/block}